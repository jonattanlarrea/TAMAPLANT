<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gemelo Digital - Planta Inteligente</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <h1>üåø Gemelo Digital - Planta Inteligente</h1>
  </header>

  <main>
    <div id="threejs-container">
      <div class="loading-message">
        Preparando modelo 3D...
        <br>
        <small style="color: #A8B2A0; margin-top: 0.5rem; display: block;">
          Aqu√≠ se cargar√° tu modelo de Blender
        </small>
      </div>
      <canvas id="scene"></canvas>
      
      <!-- Hotspots de sensores (se posicionar√°n din√°micamente) -->
      <div class="sensor-hotspot" style="top: 70%; left: 30%;" data-sensor="humidity" title="Sensor de Humedad"></div>
      <div class="sensor-hotspot" style="top: 75%; left: 50%;" data-sensor="ph" title="Sensor de pH"></div>
      <div class="sensor-hotspot" style="top: 72%; left: 70%;" data-sensor="temperature" title="Sensor de Temperatura"></div>
    </div>

    <aside id="sensor-panel">
      <h2 style="color: #00FF9D; margin-bottom: 1rem;">üìä Datos en Tiempo Real</h2>
      
      <div class="sensor-grid">
        <div class="sensor" data-sensor="humidity">
          <h3>
            <svg class="sensor-icon" viewBox="0 0 24 24">
              <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"/>
            </svg>
            Humedad del Suelo
          </h3>
          <p>45%</p>
          <div class="sensor-description">Nivel √≥ptimo</div>
          <span class="sensor-status">Normal</span>
        </div>

        <div class="sensor" data-sensor="ph">
          <h3>
            <svg class="sensor-icon" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 6v6l4 2"/>
            </svg>
            pH del Suelo
          </h3>
          <p>6.8</p>
          <div class="sensor-description">Ligeramente √°cido</div>
          <span class="sensor-status">Normal</span>
        </div>

        <div class="sensor alert" data-sensor="temperature">
          <h3>
            <svg class="sensor-icon" viewBox="0 0 24 24">
              <path d="M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z"/>
            </svg>
            Temperatura
          </h3>
          <p>28¬∞C</p>
          <div class="sensor-description">Por encima del rango</div>
          <span class="sensor-status warning">Alerta</span>
        </div>

        <div class="sensor" data-sensor="light">
          <h3>
            <svg class="sensor-icon" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="5"/>
              <line x1="12" y1="1" x2="12" y2="3"/>
              <line x1="12" y1="21" x2="12" y2="23"/>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
              <line x1="1" y1="12" x2="3" y2="12"/>
              <line x1="21" y1="12" x2="23" y2="12"/>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
            </svg>
            Luminosidad
          </h3>
          <p>850 lux</p>
          <div class="sensor-description">Buena exposici√≥n</div>
          <span class="sensor-status">Normal</span>
        </div>
      </div>

      <div class="controls">
        <button onclick="refreshData()">üîÑ Actualizar Datos</button>
        <button onclick="toggleAutoUpdate()">‚è±Ô∏è Auto-actualizar</button>
      </div>

      <div style="margin-top: 1.5rem; padding: 1rem; background-color: #121A14; border-radius: 8px; border-left: 4px solid #00FF9D;">
        <small style="color: #A8B2A0;">
          <strong style="color: #00FF9D;">üí° Tip:</strong> Haz clic en los puntos verdes sobre el modelo o en las tarjetas de sensores para ver detalles
        </small>
      </div>
    </aside>
  </main>

  <div class="tooltip" id="tooltip">
    <h4>Sensor</h4>
    <p>Informaci√≥n del sensor</p>
  </div>

  <footer>
    <p>¬© 2025 Proyecto Gemelo Digital - Jonattan Larrea | ESP32 IoT Dashboard</p>
  </footer>

  <!-- ‚ö†Ô∏è IMPORTANTE: Cargar Three.js ANTES de GLTFLoader -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
  <script src="js/app.js"></script>
</body>
</html>